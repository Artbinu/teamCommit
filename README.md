# ✅ 급여 조회 프로그램 기능 요약 (업데이트됨)  
로그인 실패 관련 보안 요구사항을 추가했습니다.  

## 1. 로그인 기능  
- 관리자와 일반 사용자가 로그인할 수 있다.  
- 로그인 시, 비밀번호는 해시되어 DB에 저장된다.  
- 로그인 후, 사용자의 역할에 따라 다르게 접근할 수 있다.  
- **로그인 실패 보안 정책:**  
  - 로그인 5회 연속 실패 시, 해당 계정은 **30분 동안 접속 불가**  
  - 로그인 실패 횟수는 일정 시간이 지나면 초기화됨 (예: 24시간 후)  
  - 로그인 차단 시 사용자에게 알림 제공  

## 2. 일반 사용자 기능 (`role='user'`)  
- 급여 조회 기능만 가능.  
- 자신의 급여 정보를 조회할 수 있다.  

## 3. 관리자 기능 (`role='admin'`)  
- **급여 관리:**  
  - 특정 사용자에게 급여 정보 추가  
  - 기존 급여 정보 수정  
  - 급여 정보 삭제  
- **사용자 관리:**  
  - 사용자 목록 보기  
  - 사용자 등록 (관리자가 직접 아이디와 비밀번호 생성)  
  - 사용자 정보 수정  
  - 사용자 삭제  
  - **로그인 실패 기록 확인 (보안 강화)**  

## 4. DB 구조  
- `users` 테이블: 로그인할 사용자 정보 저장 (`id`, `username`, `password_hash`, `role`, `login_attempts`, `lock_time`)  
- `salaries` 테이블: 급여 정보 저장 (`id`, `user_id`, `base_salary`, `tax`, `net_salary`, `paid_date`)  
- 로그인 실패 횟수(`login_attempts`)와 계정 잠금 시간(`lock_time`)을 추가하여 로그인 차단 구현 가능  

## 🔒 보안 강화  
- **비밀번호 보안:** 비밀번호 복잡성 검사 추가 (길이, 대소문자 포함, 숫자 및 특수문자 포함 여부 확인)  
- **세션 관리:** 세션 하이재킹 방지를 위한 `Secure` 및 `HttpOnly` 옵션 사용  
- **입력값 검증:** SQL Injection 방지 및 유효성 검사 철저히 수행  
- **세션 만료:** 일정 시간 후 세션 자동 만료  
- **로그인 보안:** 로그인 5회 실패 시 계정 30분 잠금 (DB에서 `lock_time`을 설정)  

## 📜 로그 기록 및 감사  
- 관리자와 사용자의 중요한 작업(급여 추가/수정/삭제, 로그인 실패 등)을 기록  
- 사용자와 관리자가 수행한 작업에 대한 시간, 사용자, 작업 내용을 감사 로그에 저장  
- **로그인 실패 기록 추가**: 누적 실패 횟수, 계정 잠금 여부를 확인할 수 있음  

## 📣 알림 시스템  
- **급여 정보 업데이트:** 급여 정보가 추가, 수정, 삭제될 때 관리자에게 알림 발송  
- **사용자 추가:** 관리자가 사용자를 추가할 때 알림 제공  
- **로그인 차단 알림:** 로그인 5회 실패 후 계정이 잠금될 경우 사용자에게 이메일 또는 시스템 알림 제공  

## 📄 기능 흐름  
- **로그인 페이지 (`/login`)**: 사용자 인증 후, 일반 사용자는 급여 조회만 가능하고, 관리자는 사용자 관리 및 급여 관리 기능 사용 가능  
- **관리자 대시보드 (`/admin`)**: 관리자만 접근 가능하며, 급여 추가/수정/삭제 및 사용자 관리 가능  
- **사용자 급여 조회 페이지 (`/salary`)**: 사용자 본인의 급여 정보만 조회 가능  
- **로그 기록 및 알림 시스템**:  
  - 관리자가 사용자 정보를 추가하거나 급여를 수정할 때마다 로그 기록 및 알림 발송  
  - 로그인 실패 시 계정 차단 후 알림 제공  

## 💻 서버 환경  
- **웹서버:** Ubuntu 20.04.6, Gunicorn 사용  
- **DB 서버:** NAS, MariaDB, 원격 접속 허용 (`payroll_db` 데이터베이스 및 사용자 계정 생성)  
- **서버 간 연결:** 웹서버와 DB 서버가 서로 통신할 수 있도록 방화벽 설정 및 IP 허용  